

## 内网穿透原理
[TOC]

+ Ipv4资源匮乏，很多用户只能从运营商那里拿到私有IP；
+ 公网Ip价格昂贵，而我们只需要对外暴露服务，不关心IP的数量；




### NAPT

NAPT:map private_ip:port1 to public_ip_port2
NAPT，也叫“网络端口地址转换”。因为一般一个服务都是通过一个端口来提供，因此通过这种方式可以将特定的服务通过特定的规则开放到少量的公网IP上。

+ 缺点：需要在 拥有公网IP的机器上配置



### 内网穿透


以80端口代理为例子：


1. 公网ip 打开80端口，监听公网请求
2. 公网ip打开一个随机端口和私网ip的随机端口建立隧道
3. 公网ip把80端口收到的信息通过隧道传到私网ip，私服再传给自己的80端口
4. 私服处理完毕后通过隧道发送给公网ip服务器